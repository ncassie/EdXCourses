<!DOCTYPE html>
<html>
    <head>
      <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>

      <script>

      document.addEventListener('DOMContentLoaded', () => {


          // Connect to websocket
          var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port);

          // When connected, configure buttons
          socket.on('connect', () => {

              // Each button should emit a "submit vote" event
              document.querySelectorAll('button').forEach(button => {
                  button.onclick = () => {
                      const chatname = document.querySelector('#chatname').value;
                      socket.emit('create chat', {'chatname': chatname});
                  };
              });
          });

          // When a new vote is announced, add to the unordered list
          socket.on('chat created', data => {



              const option = document.createElement('option');
              option.setAttribute("value", `${data.chatname}`);
              option.innerHTML = `${data.chatname}`;
              document.querySelector("#chatlist").add(option);

          });
        });

          var user = '{{ message }}';

          localStorage.setItem('userTest2', user);

      </script>
        <title>Chat Site</title>
    </head>
    <body>
        <h3>Welcome to the Chat Site!</h3>

        <select id="chatlist">
          {% for chat in chats %}
            <option value="{{ chat }}">{{ chat }}</option>
          {% endfor %}
        </select>

        
        <input id="chatname" autocomplete="off" autofocus placeholder="New Chat" type="text">
        <button>Create Chat</button>

        <hr>


    </body>
</html>
